# 应用流程文档 (Application Flows)

**项目名称**: [项目名称]  
**重构目标**: [重构目标]  
**创建日期**: [日期]  
**源路径**: [源代码路径]

---

## 1. 用户需求映射

### 1.1 核心用户故事

| 用户故事ID | 用户角色 | 需求描述 | 业务价值 | 优先级 |
|-----------|----------|----------|----------|--------|
| US-001 | [角色] | [用户需求描述] | [业务价值] | [高/中/低] |
| US-002 | [角色] | [用户需求描述] | [业务价值] | [高/中/低] |

### 1.2 功能需求清单

| 需求ID | 需求描述 | 对应用户故事 | 验收标准 | 优先级 |
|--------|----------|--------------|----------|--------|
| REQ-001 | [功能需求] | US-001 | [验收标准] | P0 |
| REQ-002 | [功能需求] | US-001 | [验收标准] | P1 |

---

## 2. UX交互逻辑

### 2.1 主要用户流程

#### 流程1: [流程名称]
**描述**: [流程描述]  
**触发条件**: [触发条件]  
**用户角色**: [用户角色]

**步骤序列**:
1. [步骤1] - [操作描述]
   - 用户动作: [具体操作]
   - 系统响应: [系统反馈]
   - 界面变化: [界面状态变化]

2. [步骤2] - [操作描述]
   - 用户动作: [具体操作]
   - 系统响应: [系统反馈]
   - 界面变化: [界面状态变化]

**业务规则**:
- [规则1]
- [规则2]

**异常处理**:
- [异常情况1]: [处理方式]
- [异常情况2]: [处理方式]

### 2.2 界面状态转换

#### 页面/组件: [页面或组件名称]
**初始状态**: [初始状态描述]

| 状态 | 触发条件 | 界面表现 | 可用操作 |
|------|----------|----------|----------|
| [状态1] | [触发条件] | [界面表现] | [可用操作列表] |
| [状态2] | [触发条件] | [界面表现] | [可用操作列表] |

### 2.3 数据流映射

#### 数据流: [数据流名称]
**源**: [数据来源]  
**目标**: [数据目标]  
**触发**: [触发条件]

**数据转换过程**:
1. [转换步骤1]
2. [转换步骤2]
3. [转换步骤3]

---

## 3. 业务逻辑映射

### 3.1 核心业务规则

| 规则ID | 规则描述 | 适用场景 | 实现位置 | 重构要求 |
|--------|----------|----------|----------|----------|
| BR-001 | [业务规则] | [适用场景] | [源代码位置] | [保持/优化] |
| BR-002 | [业务规则] | [适用场景] | [源代码位置] | [保持/优化] |

### 3.2 计算逻辑

| 计算项 | 计算公式 | 输入参数 | 输出结果 | 重构要求 |
|--------|----------|----------|----------|----------|
| [计算名称] | [公式] | [参数列表] | [结果] | [保持/优化] |

### 3.3 验证规则

| 验证项 | 验证规则 | 错误消息 | 触发时机 | 重构要求 |
|--------|----------|----------|----------|----------|
| [验证名称] | [规则描述] | [错误信息] | [触发条件] | [保持/优化] |

---

## 4. 交互模式

### 4.1 用户交互模式

#### 模式1: [交互模式名称]
**描述**: [模式描述]  
**使用场景**: [使用场景]

**交互流程**:
1. 用户: [用户操作]
2. 系统: [系统响应]
3. 用户: [用户操作]
4. 系统: [系统响应]

### 4.2 导航结构

```
[页面1] → [页面2] → [页面3] → [页面4]
    ↓          ↓          ↓
[子页面A]  [子页面B]  [子页面C]
```

**导航规则**:
- [规则1]
- [规则2]

---

## 5. 重构合规性要求

### 5.1 功能保持要求

- [x] **100%业务逻辑保持**: 所有业务规则和计算逻辑必须完全保持
- [x] **用户流程不变**: 用户操作流程和步骤顺序必须保持一致
- [x] **数据流保持**: 数据在系统中的流转路径必须保持一致
- [ ] **UI/UX可优化**: 界面布局和交互体验可以基于新技术栈优化

### 5.2 验证标准

| 验证项目 | 验证方法 | 预期结果 | 优先级 |
|----------|----------|----------|--------|
| 业务逻辑完整性 | 端到端测试 | 100%功能一致 | P0 |
| 用户流程正确性 | 用户验收测试 | 用户无感知差异 | P0 |
| 数据流准确性 | 数据对比测试 | 数据完全一致 | P1 |

### 5.3 用户体验优化点

**允许优化的方面**:
- [ ] 界面响应速度优化
- [ ] 视觉设计现代化
- [ ] 交互体验改进
- [ ] 移动端适配增强
- [ ] 可访问性提升

**禁止变更的方面**:
- [x] 核心业务逻辑
- [x] 数据模型结构
- [x] API调用方式
- [x] 用户操作流程

---

## 6. 重构验证清单

### 6.1 Phase 1: 基线验证
- [ ] 所有用户流程已文档化
- [ ] 业务规则已完整映射
- [ ] 数据流已清晰定义
- [ ] 验收标准已明确

### 6.2 Phase 2: 实现验证
- [ ] 新实现业务逻辑100%一致
- [ ] 用户操作流程完全保持
- [ ] 数据流转路径不变
- [ ] 错误处理行为一致

### 6.3 Phase 3: 用户验收
- [ ] 用户操作无感知差异
- [ ] 业务结果完全一致
- [ ] 性能不劣于原系统
- [ ] UX体验符合预期

---

**文档状态**: [草稿/完成/已验证]  
**最后更新**: [更新日期]  
**更新人**: [更新者]  

---

*本文档与data-models.md和apis.md共同构成重构的完整契约文档*